"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("core-js/modules/es.symbol.description.js");
require("core-js/modules/es.array.flat-map.js");
require("core-js/modules/es.array.iterator.js");
require("core-js/modules/es.array.sort.js");
require("core-js/modules/es.array.unscopables.flat-map.js");
require("core-js/modules/es.promise.js");
require("core-js/modules/es.regexp.exec.js");
require("core-js/modules/es.string.replace.js");
require("core-js/modules/es.string.trim.js");
require("core-js/modules/esnext.string.match-all.js");
var _moment = _interopRequireDefault(require("moment/moment"));
var _debug = require("../helpers/debug");
var _fetch = require("../helpers/fetch");
var _transactions = require("../transactions");
var _baseScraper = require("./base-scraper");
var _errors = require("./errors");
var _oneZeroQueries = require("./one-zero-queries");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
const HEBREW_WORDS_REGEX = /[\u0590-\u05FF][\u0590-\u05FF"'\-_ /\\]*[\u0590-\u05FF]/g;
const debug = (0, _debug.getDebug)('one-zero');
const IDENTITY_SERVER_URL = 'https://identity.tfd-bank.com/v1/';
const GRAPHQL_API_URL = 'https://mobile.tfd-bank.com/mobile-graph/graphql';
class OneZeroScraper extends _baseScraper.BaseScraper {
  constructor(...args) {
    super(...args);
    _defineProperty(this, "otpContext", void 0);
    _defineProperty(this, "accessToken", void 0);
  }
  async triggerTwoFactorAuth(phoneNumber) {
    if (!phoneNumber.startsWith('+')) {
      return (0, _errors.createGenericError)('A full international phone number starting with + and a three digit country code is required');
    }
    debug('Fetching device token');
    const deviceTokenResponse = await (0, _fetch.fetchPost)(`${IDENTITY_SERVER_URL}/devices/token`, {
      extClientId: 'mobile',
      os: 'Android'
    });
    const {
      resultData: {
        deviceToken
      }
    } = deviceTokenResponse;
    debug(`Sending OTP to phone number ${phoneNumber}`);
    const otpPrepareResponse = await (0, _fetch.fetchPost)(`${IDENTITY_SERVER_URL}/otp/prepare`, {
      factorValue: phoneNumber,
      deviceToken,
      otpChannel: 'SMS_OTP'
    });
    const {
      resultData: {
        otpContext
      }
    } = otpPrepareResponse;
    this.otpContext = otpContext;
    return {
      success: true
    };
  }
  async getLongTermTwoFactorToken(otpCode) {
    if (!this.otpContext) {
      return (0, _errors.createGenericError)('triggerOtp was not called before calling getPermenantOtpToken()');
    }
    debug('Requesting OTP token');
    const otpVerifyResponse = await (0, _fetch.fetchPost)(`${IDENTITY_SERVER_URL}/otp/verify`, {
      otpContext: this.otpContext,
      otpCode
    });
    const {
      resultData: {
        otpToken
      }
    } = otpVerifyResponse;
    return {
      success: true,
      longTermTwoFactorAuthToken: otpToken
    };
  }
  async resolveOtpToken(credentials) {
    if ('otpLongTermToken' in credentials) {
      if (!credentials.otpLongTermToken) {
        return (0, _errors.createGenericError)('Invalid otpLongTermToken');
      }
      return {
        success: true,
        longTermTwoFactorAuthToken: credentials.otpLongTermToken
      };
    }
    if (!credentials.otpCodeRetriever) {
      return {
        success: false,
        errorType: _errors.ScraperErrorTypes.TwoFactorRetrieverMissing,
        errorMessage: 'otpCodeRetriever is required when otpPermanentToken is not provided'
      };
    }
    if (!credentials.phoneNumber) {
      return (0, _errors.createGenericError)('phoneNumber is required when providing a otpCodeRetriever callback');
    }
    debug('Triggering user supplied otpCodeRetriever callback');
    const triggerResult = await this.triggerTwoFactorAuth(credentials.phoneNumber);
    if (!triggerResult.success) {
      return triggerResult;
    }
    const otpCode = await credentials.otpCodeRetriever();
    const otpTokenResult = await this.getLongTermTwoFactorToken(otpCode);
    if (!otpTokenResult.success) {
      return otpTokenResult;
    }
    return {
      success: true,
      longTermTwoFactorAuthToken: otpTokenResult.longTermTwoFactorAuthToken
    };
  }
  async login(credentials) {
    const otpTokenResult = await this.resolveOtpToken(credentials);
    if (!otpTokenResult.success) {
      return otpTokenResult;
    }
    debug('Requesting id token');
    const getIdTokenResponse = await (0, _fetch.fetchPost)(`${IDENTITY_SERVER_URL}/getIdToken`, {
      otpSmsToken: otpTokenResult.longTermTwoFactorAuthToken,
      email: credentials.email,
      pass: credentials.password,
      pinCode: ''
    });
    const {
      resultData: {
        idToken
      }
    } = getIdTokenResponse;
    debug('Requesting session token');
    const getSessionTokenResponse = await (0, _fetch.fetchPost)(`${IDENTITY_SERVER_URL}/sessions/token`, {
      idToken,
      pass: credentials.password
    });
    const {
      resultData: {
        accessToken
      }
    } = getSessionTokenResponse;
    this.accessToken = accessToken;
    return {
      success: true,
      persistentOtpToken: otpTokenResult.longTermTwoFactorAuthToken
    };
  }
  async fetchPortfolioMovements(portfolio, startDate) {
    // TODO: Find out if we need the other accounts, there seems to always be one
    const account = portfolio.accounts[0];
    let cursor = null;
    const movements = [];
    while (!movements.length || new Date(movements[0].movementTimestamp) >= startDate) {
      debug(`Fetching transactions for account ${portfolio.portfolioNum}...`);
      const {
        movements: {
          movements: newMovements,
          pagination
        }
      } = await (0, _fetch.fetchGraphql)(GRAPHQL_API_URL, _oneZeroQueries.GET_MOVEMENTS, {
        portfolioId: portfolio.portfolioId,
        accountId: account.accountId,
        language: 'HEBREW',
        pagination: {
          cursor,
          limit: 50
        }
      }, {
        authorization: `Bearer ${this.accessToken}`
      });
      movements.unshift(...newMovements);
      cursor = pagination.cursor;
      if (!pagination.hasMore) {
        break;
      }
    }
    movements.sort((x, y) => new Date(x.movementTimestamp).valueOf() - new Date(y.movementTimestamp).valueOf());
    const matchingMovements = movements.filter(movement => new Date(movement.movementTimestamp) >= startDate);
    return {
      accountNumber: portfolio.portfolioNum,
      balance: !movements.length ? 0 : parseFloat(movements[movements.length - 1].runningBalance),
      txns: matchingMovements.map(movement => {
        var _movement$transaction;
        const hasInstallments = (_movement$transaction = movement.transaction) === null || _movement$transaction === void 0 || (_movement$transaction = _movement$transaction.enrichment) === null || _movement$transaction === void 0 || (_movement$transaction = _movement$transaction.recurrences) === null || _movement$transaction === void 0 ? void 0 : _movement$transaction.some(x => x.isRecurrent);
        const modifier = movement.creditDebit === 'DEBIT' ? -1 : 1;
        return {
          identifier: movement.movementId,
          date: movement.valueDate,
          chargedAmount: +movement.movementAmount * modifier,
          chargedCurrency: movement.movementCurrency,
          originalAmount: +movement.movementAmount * modifier,
          originalCurrency: movement.movementCurrency,
          description: this.sanitizeHebrew(movement.description),
          processedDate: movement.movementTimestamp,
          status: _transactions.TransactionStatuses.Completed,
          type: hasInstallments ? _transactions.TransactionTypes.Installments : _transactions.TransactionTypes.Normal
        };
      })
    };
  }

  /**
   * one zero hebrew strings are reversed with a unicode control character that forces display in LTR order
   * We need to remove the unicode control character, and then reverse hebrew substrings inside the string
   */
  sanitizeHebrew(text) {
    if (!text.includes('\u202d')) {
      return text.trim();
    }
    const plainString = text.replace(/\u202d/gi, '').trim();
    const hebrewSubStringsRanges = [...plainString.matchAll(HEBREW_WORDS_REGEX)];
    const rangesToReverse = hebrewSubStringsRanges.map(str => ({
      start: str.index,
      end: str.index + str[0].length
    }));
    const out = [];
    let index = 0;
    for (const {
      start,
      end
    } of rangesToReverse) {
      out.push(...plainString.substring(index, start));
      index += start - index;
      const reversed = [...plainString.substring(start, end)].reverse();
      out.push(...reversed);
      index += end - start;
    }
    out.push(...plainString.substring(index, plainString.length));
    return out.join('');
  }
  async fetchData() {
    if (!this.accessToken) {
      return (0, _errors.createGenericError)('login() was not called');
    }
    const defaultStartMoment = (0, _moment.default)().subtract(1, 'years').add(1, 'day');
    const startDate = this.options.startDate || defaultStartMoment.toDate();
    const startMoment = _moment.default.max(defaultStartMoment, (0, _moment.default)(startDate));
    debug('Fetching account list');
    const result = await (0, _fetch.fetchGraphql)(GRAPHQL_API_URL, _oneZeroQueries.GET_CUSTOMER, {}, {
      authorization: `Bearer ${this.accessToken}`
    });
    const portfolios = result.customer.flatMap(customer => customer.portfolios || []);
    return {
      success: true,
      accounts: await Promise.all(portfolios.map(portfolio => this.fetchPortfolioMovements(portfolio, startMoment.toDate())))
    };
  }
}
exports.default = OneZeroScraper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfZGVidWciLCJfZmV0Y2giLCJfdHJhbnNhY3Rpb25zIiwiX2Jhc2VTY3JhcGVyIiwiX2Vycm9ycyIsIl9vbmVaZXJvUXVlcmllcyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZpbmVQcm9wZXJ0eSIsInIiLCJ0IiwiX3RvUHJvcGVydHlLZXkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiaSIsIl90b1ByaW1pdGl2ZSIsIlN5bWJvbCIsInRvUHJpbWl0aXZlIiwiY2FsbCIsIlR5cGVFcnJvciIsIlN0cmluZyIsIk51bWJlciIsIkhFQlJFV19XT1JEU19SRUdFWCIsImRlYnVnIiwiZ2V0RGVidWciLCJJREVOVElUWV9TRVJWRVJfVVJMIiwiR1JBUEhRTF9BUElfVVJMIiwiT25lWmVyb1NjcmFwZXIiLCJCYXNlU2NyYXBlciIsImNvbnN0cnVjdG9yIiwiYXJncyIsInRyaWdnZXJUd29GYWN0b3JBdXRoIiwicGhvbmVOdW1iZXIiLCJzdGFydHNXaXRoIiwiY3JlYXRlR2VuZXJpY0Vycm9yIiwiZGV2aWNlVG9rZW5SZXNwb25zZSIsImZldGNoUG9zdCIsImV4dENsaWVudElkIiwib3MiLCJyZXN1bHREYXRhIiwiZGV2aWNlVG9rZW4iLCJvdHBQcmVwYXJlUmVzcG9uc2UiLCJmYWN0b3JWYWx1ZSIsIm90cENoYW5uZWwiLCJvdHBDb250ZXh0Iiwic3VjY2VzcyIsImdldExvbmdUZXJtVHdvRmFjdG9yVG9rZW4iLCJvdHBDb2RlIiwib3RwVmVyaWZ5UmVzcG9uc2UiLCJvdHBUb2tlbiIsImxvbmdUZXJtVHdvRmFjdG9yQXV0aFRva2VuIiwicmVzb2x2ZU90cFRva2VuIiwiY3JlZGVudGlhbHMiLCJvdHBMb25nVGVybVRva2VuIiwib3RwQ29kZVJldHJpZXZlciIsImVycm9yVHlwZSIsIlNjcmFwZXJFcnJvclR5cGVzIiwiVHdvRmFjdG9yUmV0cmlldmVyTWlzc2luZyIsImVycm9yTWVzc2FnZSIsInRyaWdnZXJSZXN1bHQiLCJvdHBUb2tlblJlc3VsdCIsImxvZ2luIiwiZ2V0SWRUb2tlblJlc3BvbnNlIiwib3RwU21zVG9rZW4iLCJlbWFpbCIsInBhc3MiLCJwYXNzd29yZCIsInBpbkNvZGUiLCJpZFRva2VuIiwiZ2V0U2Vzc2lvblRva2VuUmVzcG9uc2UiLCJhY2Nlc3NUb2tlbiIsInBlcnNpc3RlbnRPdHBUb2tlbiIsImZldGNoUG9ydGZvbGlvTW92ZW1lbnRzIiwicG9ydGZvbGlvIiwic3RhcnREYXRlIiwiYWNjb3VudCIsImFjY291bnRzIiwiY3Vyc29yIiwibW92ZW1lbnRzIiwibGVuZ3RoIiwiRGF0ZSIsIm1vdmVtZW50VGltZXN0YW1wIiwicG9ydGZvbGlvTnVtIiwibmV3TW92ZW1lbnRzIiwicGFnaW5hdGlvbiIsImZldGNoR3JhcGhxbCIsIkdFVF9NT1ZFTUVOVFMiLCJwb3J0Zm9saW9JZCIsImFjY291bnRJZCIsImxhbmd1YWdlIiwibGltaXQiLCJhdXRob3JpemF0aW9uIiwidW5zaGlmdCIsImhhc01vcmUiLCJzb3J0IiwieCIsInkiLCJ2YWx1ZU9mIiwibWF0Y2hpbmdNb3ZlbWVudHMiLCJmaWx0ZXIiLCJtb3ZlbWVudCIsImFjY291bnROdW1iZXIiLCJiYWxhbmNlIiwicGFyc2VGbG9hdCIsInJ1bm5pbmdCYWxhbmNlIiwidHhucyIsIm1hcCIsIl9tb3ZlbWVudCR0cmFuc2FjdGlvbiIsImhhc0luc3RhbGxtZW50cyIsInRyYW5zYWN0aW9uIiwiZW5yaWNobWVudCIsInJlY3VycmVuY2VzIiwic29tZSIsImlzUmVjdXJyZW50IiwibW9kaWZpZXIiLCJjcmVkaXREZWJpdCIsImlkZW50aWZpZXIiLCJtb3ZlbWVudElkIiwiZGF0ZSIsInZhbHVlRGF0ZSIsImNoYXJnZWRBbW91bnQiLCJtb3ZlbWVudEFtb3VudCIsImNoYXJnZWRDdXJyZW5jeSIsIm1vdmVtZW50Q3VycmVuY3kiLCJvcmlnaW5hbEFtb3VudCIsIm9yaWdpbmFsQ3VycmVuY3kiLCJkZXNjcmlwdGlvbiIsInNhbml0aXplSGVicmV3IiwicHJvY2Vzc2VkRGF0ZSIsInN0YXR1cyIsIlRyYW5zYWN0aW9uU3RhdHVzZXMiLCJDb21wbGV0ZWQiLCJ0eXBlIiwiVHJhbnNhY3Rpb25UeXBlcyIsIkluc3RhbGxtZW50cyIsIk5vcm1hbCIsInRleHQiLCJpbmNsdWRlcyIsInRyaW0iLCJwbGFpblN0cmluZyIsInJlcGxhY2UiLCJoZWJyZXdTdWJTdHJpbmdzUmFuZ2VzIiwibWF0Y2hBbGwiLCJyYW5nZXNUb1JldmVyc2UiLCJzdHIiLCJzdGFydCIsImluZGV4IiwiZW5kIiwib3V0IiwicHVzaCIsInN1YnN0cmluZyIsInJldmVyc2VkIiwicmV2ZXJzZSIsImpvaW4iLCJmZXRjaERhdGEiLCJkZWZhdWx0U3RhcnRNb21lbnQiLCJtb21lbnQiLCJzdWJ0cmFjdCIsImFkZCIsIm9wdGlvbnMiLCJ0b0RhdGUiLCJzdGFydE1vbWVudCIsIm1heCIsInJlc3VsdCIsIkdFVF9DVVNUT01FUiIsInBvcnRmb2xpb3MiLCJjdXN0b21lciIsImZsYXRNYXAiLCJQcm9taXNlIiwiYWxsIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY3JhcGVycy9vbmUtemVyby50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudC9tb21lbnQnO1xuaW1wb3J0IHsgZ2V0RGVidWcgfSBmcm9tICcuLi9oZWxwZXJzL2RlYnVnJztcbmltcG9ydCB7IGZldGNoR3JhcGhxbCwgZmV0Y2hQb3N0IH0gZnJvbSAnLi4vaGVscGVycy9mZXRjaCc7XG5pbXBvcnQge1xuICB0eXBlIFRyYW5zYWN0aW9uIGFzIFNjcmFwaW5nVHJhbnNhY3Rpb24sXG4gIFRyYW5zYWN0aW9uU3RhdHVzZXMsXG4gIFRyYW5zYWN0aW9uVHlwZXMsXG4gIHR5cGUgVHJhbnNhY3Rpb25zQWNjb3VudCxcbn0gZnJvbSAnLi4vdHJhbnNhY3Rpb25zJztcbmltcG9ydCB7IEJhc2VTY3JhcGVyIH0gZnJvbSAnLi9iYXNlLXNjcmFwZXInO1xuaW1wb3J0IHsgU2NyYXBlckVycm9yVHlwZXMsIGNyZWF0ZUdlbmVyaWNFcnJvciB9IGZyb20gJy4vZXJyb3JzJztcbmltcG9ydCB7XG4gIHR5cGUgU2NyYXBlckdldExvbmdUZXJtVHdvRmFjdG9yVG9rZW5SZXN1bHQsIHR5cGUgU2NyYXBlckxvZ2luUmVzdWx0LFxuICB0eXBlIFNjcmFwZXJTY3JhcGluZ1Jlc3VsdCwgdHlwZSBTY3JhcGVyVHdvRmFjdG9yQXV0aFRyaWdnZXJSZXN1bHQsXG59IGZyb20gJy4vaW50ZXJmYWNlJztcbmltcG9ydCB7IEdFVF9DVVNUT01FUiwgR0VUX01PVkVNRU5UUyB9IGZyb20gJy4vb25lLXplcm8tcXVlcmllcyc7XG5cbmNvbnN0IEhFQlJFV19XT1JEU19SRUdFWCA9IC9bXFx1MDU5MC1cXHUwNUZGXVtcXHUwNTkwLVxcdTA1RkZcIidcXC1fIC9cXFxcXSpbXFx1MDU5MC1cXHUwNUZGXS9nO1xuXG5jb25zdCBkZWJ1ZyA9IGdldERlYnVnKCdvbmUtemVybycpO1xuXG50eXBlIEFjY291bnQgPSB7XG4gIGFjY291bnRJZDogc3RyaW5nO1xufTtcblxudHlwZSBQb3J0Zm9saW8gPSB7XG4gIGFjY291bnRzOiBBcnJheTxBY2NvdW50PjtcbiAgcG9ydGZvbGlvSWQ6IHN0cmluZztcbiAgcG9ydGZvbGlvTnVtOiBzdHJpbmc7XG59O1xuXG50eXBlIEN1c3RvbWVyID0ge1xuICBjdXN0b21lcklkOiBzdHJpbmc7XG4gIHBvcnRmb2xpb3M/OiBBcnJheTxQb3J0Zm9saW8+IHwgbnVsbDtcbn07XG5cbmV4cG9ydCB0eXBlIENhdGVnb3J5ID0ge1xuICBjYXRlZ29yeUlkOiBudW1iZXI7XG4gIGRhdGFTb3VyY2U6IHN0cmluZztcbiAgc3ViQ2F0ZWdvcnlJZD86IG51bWJlciB8IG51bGw7XG59O1xuXG5leHBvcnQgdHlwZSBSZWN1cnJlbmNlID0ge1xuICBkYXRhU291cmNlOiBzdHJpbmc7XG4gIGlzUmVjdXJyZW50OiBib29sZWFuO1xufTtcblxudHlwZSBUcmFuc2FjdGlvbkVucmljaG1lbnQgPSB7XG4gIGNhdGVnb3JpZXM/OiBDYXRlZ29yeVtdIHwgbnVsbDtcbiAgcmVjdXJyZW5jZXM/OiBSZWN1cnJlbmNlW10gfCBudWxsO1xufTtcblxudHlwZSBUcmFuc2FjdGlvbiA9IHtcbiAgZW5yaWNobWVudD86IFRyYW5zYWN0aW9uRW5yaWNobWVudCB8IG51bGw7XG4gIC8vIFRPRE86IEdldCBpbnN0YWxsbWVudHMgaW5mb3JtYXRpb24gaGVyZVxuICAvLyB0cmFuc2FjdGlvbkRldGFpbHM6IFRyYW5zYWN0aW9uRGV0YWlscztcbn07XG5cbnR5cGUgTW92ZW1lbnQgPSB7XG4gIGFjY291bnRJZDogc3RyaW5nO1xuICBiYW5rQ3VycmVuY3lBbW91bnQ6IHN0cmluZztcbiAgYm9va2luZ0RhdGU6IHN0cmluZztcbiAgY29udmVyc2lvblJhdGU6IHN0cmluZztcbiAgY3JlZGl0RGViaXQ6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgaXNSZXZlcnNlZDogYm9vbGVhbjtcbiAgbW92ZW1lbnRBbW91bnQ6IHN0cmluZztcbiAgbW92ZW1lbnRDdXJyZW5jeTogc3RyaW5nO1xuICBtb3ZlbWVudElkOiBzdHJpbmc7XG4gIG1vdmVtZW50UmV2ZXJzZWRJZD86IHN0cmluZyB8IG51bGw7XG4gIG1vdmVtZW50VGltZXN0YW1wOiBzdHJpbmc7XG4gIG1vdmVtZW50VHlwZTogc3RyaW5nO1xuICBwb3J0Zm9saW9JZDogc3RyaW5nO1xuICBydW5uaW5nQmFsYW5jZTogc3RyaW5nO1xuICB0cmFuc2FjdGlvbj86IFRyYW5zYWN0aW9uIHwgbnVsbDtcbiAgdmFsdWVEYXRlOiBzdHJpbmc7XG59O1xuXG50eXBlIFF1ZXJ5UGFnaW5hdGlvbiA9IHsgaGFzTW9yZTogYm9vbGVhbiwgY3Vyc29yOiBzdHJpbmcgfTtcblxuY29uc3QgSURFTlRJVFlfU0VSVkVSX1VSTCA9ICdodHRwczovL2lkZW50aXR5LnRmZC1iYW5rLmNvbS92MS8nO1xuXG5jb25zdCBHUkFQSFFMX0FQSV9VUkwgPSAnaHR0cHM6Ly9tb2JpbGUudGZkLWJhbmsuY29tL21vYmlsZS1ncmFwaC9ncmFwaHFsJztcblxudHlwZSBTY3JhcGVyU3BlY2lmaWNDcmVkZW50aWFscyA9IHsgZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZyB9ICYgKHtcbiAgb3RwQ29kZVJldHJpZXZlcjogKCkgPT4gUHJvbWlzZTxzdHJpbmc+O1xuICBwaG9uZU51bWJlcjogc3RyaW5nO1xufSB8IHtcbiAgb3RwTG9uZ1Rlcm1Ub2tlbjogc3RyaW5nO1xufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9uZVplcm9TY3JhcGVyIGV4dGVuZHMgQmFzZVNjcmFwZXI8U2NyYXBlclNwZWNpZmljQ3JlZGVudGlhbHM+IHtcbiAgcHJpdmF0ZSBvdHBDb250ZXh0Pzogc3RyaW5nO1xuXG4gIHByaXZhdGUgYWNjZXNzVG9rZW4/OiBzdHJpbmc7XG5cbiAgYXN5bmMgdHJpZ2dlclR3b0ZhY3RvckF1dGgocGhvbmVOdW1iZXI6IHN0cmluZyk6IFByb21pc2U8U2NyYXBlclR3b0ZhY3RvckF1dGhUcmlnZ2VyUmVzdWx0PiB7XG4gICAgaWYgKCFwaG9uZU51bWJlci5zdGFydHNXaXRoKCcrJykpIHtcbiAgICAgIHJldHVybiBjcmVhdGVHZW5lcmljRXJyb3IoJ0EgZnVsbCBpbnRlcm5hdGlvbmFsIHBob25lIG51bWJlciBzdGFydGluZyB3aXRoICsgYW5kIGEgdGhyZWUgZGlnaXQgY291bnRyeSBjb2RlIGlzIHJlcXVpcmVkJyk7XG4gICAgfVxuXG4gICAgZGVidWcoJ0ZldGNoaW5nIGRldmljZSB0b2tlbicpO1xuICAgIGNvbnN0IGRldmljZVRva2VuUmVzcG9uc2UgPSBhd2FpdCBmZXRjaFBvc3QoYCR7SURFTlRJVFlfU0VSVkVSX1VSTH0vZGV2aWNlcy90b2tlbmAsIHtcbiAgICAgIGV4dENsaWVudElkOiAnbW9iaWxlJyxcbiAgICAgIG9zOiAnQW5kcm9pZCcsXG4gICAgfSk7XG5cbiAgICBjb25zdCB7IHJlc3VsdERhdGE6IHsgZGV2aWNlVG9rZW4gfSB9ID0gZGV2aWNlVG9rZW5SZXNwb25zZTtcblxuICAgIGRlYnVnKGBTZW5kaW5nIE9UUCB0byBwaG9uZSBudW1iZXIgJHtwaG9uZU51bWJlcn1gKTtcblxuICAgIGNvbnN0IG90cFByZXBhcmVSZXNwb25zZSA9IGF3YWl0IGZldGNoUG9zdChgJHtJREVOVElUWV9TRVJWRVJfVVJMfS9vdHAvcHJlcGFyZWAsIHtcbiAgICAgIGZhY3RvclZhbHVlOiBwaG9uZU51bWJlcixcbiAgICAgIGRldmljZVRva2VuLFxuICAgICAgb3RwQ2hhbm5lbDogJ1NNU19PVFAnLFxuICAgIH0pO1xuXG4gICAgY29uc3QgeyByZXN1bHREYXRhOiB7IG90cENvbnRleHQgfSB9ID0gb3RwUHJlcGFyZVJlc3BvbnNlO1xuXG4gICAgdGhpcy5vdHBDb250ZXh0ID0gb3RwQ29udGV4dDtcblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgIH07XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0TG9uZ1Rlcm1Ud29GYWN0b3JUb2tlbihvdHBDb2RlOiBzdHJpbmcpOiBQcm9taXNlPFNjcmFwZXJHZXRMb25nVGVybVR3b0ZhY3RvclRva2VuUmVzdWx0PiB7XG4gICAgaWYgKCF0aGlzLm90cENvbnRleHQpIHtcbiAgICAgIHJldHVybiBjcmVhdGVHZW5lcmljRXJyb3IoJ3RyaWdnZXJPdHAgd2FzIG5vdCBjYWxsZWQgYmVmb3JlIGNhbGxpbmcgZ2V0UGVybWVuYW50T3RwVG9rZW4oKScpO1xuICAgIH1cblxuICAgIGRlYnVnKCdSZXF1ZXN0aW5nIE9UUCB0b2tlbicpO1xuICAgIGNvbnN0IG90cFZlcmlmeVJlc3BvbnNlID0gYXdhaXQgZmV0Y2hQb3N0KGAke0lERU5USVRZX1NFUlZFUl9VUkx9L290cC92ZXJpZnlgLCB7XG4gICAgICBvdHBDb250ZXh0OiB0aGlzLm90cENvbnRleHQsXG4gICAgICBvdHBDb2RlLFxuICAgIH0pO1xuXG4gICAgY29uc3QgeyByZXN1bHREYXRhOiB7IG90cFRva2VuIH0gfSA9IG90cFZlcmlmeVJlc3BvbnNlO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGxvbmdUZXJtVHdvRmFjdG9yQXV0aFRva2VuOiBvdHBUb2tlbiB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZXNvbHZlT3RwVG9rZW4oXG4gICAgY3JlZGVudGlhbHM6IFNjcmFwZXJTcGVjaWZpY0NyZWRlbnRpYWxzLFxuICApOiBQcm9taXNlPFNjcmFwZXJHZXRMb25nVGVybVR3b0ZhY3RvclRva2VuUmVzdWx0PiB7XG4gICAgaWYgKCdvdHBMb25nVGVybVRva2VuJyBpbiBjcmVkZW50aWFscykge1xuICAgICAgaWYgKCFjcmVkZW50aWFscy5vdHBMb25nVGVybVRva2VuKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVHZW5lcmljRXJyb3IoJ0ludmFsaWQgb3RwTG9uZ1Rlcm1Ub2tlbicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgbG9uZ1Rlcm1Ud29GYWN0b3JBdXRoVG9rZW46IGNyZWRlbnRpYWxzLm90cExvbmdUZXJtVG9rZW4gfTtcbiAgICB9XG5cbiAgICBpZiAoIWNyZWRlbnRpYWxzLm90cENvZGVSZXRyaWV2ZXIpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvclR5cGU6IFNjcmFwZXJFcnJvclR5cGVzLlR3b0ZhY3RvclJldHJpZXZlck1pc3NpbmcsXG4gICAgICAgIGVycm9yTWVzc2FnZTogJ290cENvZGVSZXRyaWV2ZXIgaXMgcmVxdWlyZWQgd2hlbiBvdHBQZXJtYW5lbnRUb2tlbiBpcyBub3QgcHJvdmlkZWQnLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoIWNyZWRlbnRpYWxzLnBob25lTnVtYmVyKSB7XG4gICAgICByZXR1cm4gY3JlYXRlR2VuZXJpY0Vycm9yKCdwaG9uZU51bWJlciBpcyByZXF1aXJlZCB3aGVuIHByb3ZpZGluZyBhIG90cENvZGVSZXRyaWV2ZXIgY2FsbGJhY2snKTtcbiAgICB9XG5cbiAgICBkZWJ1ZygnVHJpZ2dlcmluZyB1c2VyIHN1cHBsaWVkIG90cENvZGVSZXRyaWV2ZXIgY2FsbGJhY2snKTtcbiAgICBjb25zdCB0cmlnZ2VyUmVzdWx0ID0gYXdhaXQgdGhpcy50cmlnZ2VyVHdvRmFjdG9yQXV0aChjcmVkZW50aWFscy5waG9uZU51bWJlcik7XG5cbiAgICBpZiAoIXRyaWdnZXJSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHRyaWdnZXJSZXN1bHQ7XG4gICAgfVxuXG4gICAgY29uc3Qgb3RwQ29kZSA9IGF3YWl0IGNyZWRlbnRpYWxzLm90cENvZGVSZXRyaWV2ZXIoKTtcblxuICAgIGNvbnN0IG90cFRva2VuUmVzdWx0ID0gYXdhaXQgdGhpcy5nZXRMb25nVGVybVR3b0ZhY3RvclRva2VuKG90cENvZGUpO1xuICAgIGlmICghb3RwVG9rZW5SZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIG90cFRva2VuUmVzdWx0O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGxvbmdUZXJtVHdvRmFjdG9yQXV0aFRva2VuOiBvdHBUb2tlblJlc3VsdC5sb25nVGVybVR3b0ZhY3RvckF1dGhUb2tlbiB9O1xuICB9XG5cbiAgYXN5bmMgbG9naW4oY3JlZGVudGlhbHM6IFNjcmFwZXJTcGVjaWZpY0NyZWRlbnRpYWxzKTpcbiAgUHJvbWlzZTxTY3JhcGVyTG9naW5SZXN1bHQ+IHtcbiAgICBjb25zdCBvdHBUb2tlblJlc3VsdCA9IGF3YWl0IHRoaXMucmVzb2x2ZU90cFRva2VuKGNyZWRlbnRpYWxzKTtcbiAgICBpZiAoIW90cFRva2VuUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBvdHBUb2tlblJlc3VsdDtcbiAgICB9XG5cbiAgICBkZWJ1ZygnUmVxdWVzdGluZyBpZCB0b2tlbicpO1xuICAgIGNvbnN0IGdldElkVG9rZW5SZXNwb25zZSA9IGF3YWl0IGZldGNoUG9zdChgJHtJREVOVElUWV9TRVJWRVJfVVJMfS9nZXRJZFRva2VuYCwge1xuICAgICAgb3RwU21zVG9rZW46IG90cFRva2VuUmVzdWx0LmxvbmdUZXJtVHdvRmFjdG9yQXV0aFRva2VuLFxuICAgICAgZW1haWw6IGNyZWRlbnRpYWxzLmVtYWlsLFxuICAgICAgcGFzczogY3JlZGVudGlhbHMucGFzc3dvcmQsXG4gICAgICBwaW5Db2RlOiAnJyxcbiAgICB9KTtcblxuICAgIGNvbnN0IHsgcmVzdWx0RGF0YTogeyBpZFRva2VuIH0gfSA9IGdldElkVG9rZW5SZXNwb25zZTtcblxuICAgIGRlYnVnKCdSZXF1ZXN0aW5nIHNlc3Npb24gdG9rZW4nKTtcblxuICAgIGNvbnN0IGdldFNlc3Npb25Ub2tlblJlc3BvbnNlID0gYXdhaXQgZmV0Y2hQb3N0KGAke0lERU5USVRZX1NFUlZFUl9VUkx9L3Nlc3Npb25zL3Rva2VuYCwge1xuICAgICAgaWRUb2tlbixcbiAgICAgIHBhc3M6IGNyZWRlbnRpYWxzLnBhc3N3b3JkLFxuICAgIH0pO1xuXG4gICAgY29uc3QgeyByZXN1bHREYXRhOiB7IGFjY2Vzc1Rva2VuIH0gfSA9IGdldFNlc3Npb25Ub2tlblJlc3BvbnNlO1xuXG4gICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBwZXJzaXN0ZW50T3RwVG9rZW46IG90cFRva2VuUmVzdWx0LmxvbmdUZXJtVHdvRmFjdG9yQXV0aFRva2VuLFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGZldGNoUG9ydGZvbGlvTW92ZW1lbnRzKHBvcnRmb2xpbzogUG9ydGZvbGlvLCBzdGFydERhdGU6IERhdGUpOiBQcm9taXNlPFRyYW5zYWN0aW9uc0FjY291bnQ+IHtcbiAgICAvLyBUT0RPOiBGaW5kIG91dCBpZiB3ZSBuZWVkIHRoZSBvdGhlciBhY2NvdW50cywgdGhlcmUgc2VlbXMgdG8gYWx3YXlzIGJlIG9uZVxuICAgIGNvbnN0IGFjY291bnQgPSBwb3J0Zm9saW8uYWNjb3VudHNbMF07XG4gICAgbGV0IGN1cnNvciA9IG51bGw7XG4gICAgY29uc3QgbW92ZW1lbnRzID0gW107XG5cbiAgICB3aGlsZSAoIW1vdmVtZW50cy5sZW5ndGggfHwgbmV3IERhdGUobW92ZW1lbnRzWzBdLm1vdmVtZW50VGltZXN0YW1wKSA+PSBzdGFydERhdGUpIHtcbiAgICAgIGRlYnVnKGBGZXRjaGluZyB0cmFuc2FjdGlvbnMgZm9yIGFjY291bnQgJHtwb3J0Zm9saW8ucG9ydGZvbGlvTnVtfS4uLmApO1xuICAgICAgY29uc3QgeyBtb3ZlbWVudHM6IHsgbW92ZW1lbnRzOiBuZXdNb3ZlbWVudHMsIHBhZ2luYXRpb24gfSB9OlxuICAgICAgeyBtb3ZlbWVudHM6IHsgbW92ZW1lbnRzOiBNb3ZlbWVudFtdLCBwYWdpbmF0aW9uOiBRdWVyeVBhZ2luYXRpb24gfSB9ID1cbiAgICAgICAgICBhd2FpdCBmZXRjaEdyYXBocWwoXG4gICAgICAgICAgICBHUkFQSFFMX0FQSV9VUkwsXG4gICAgICAgICAgICBHRVRfTU9WRU1FTlRTLCB7XG4gICAgICAgICAgICAgIHBvcnRmb2xpb0lkOiBwb3J0Zm9saW8ucG9ydGZvbGlvSWQsXG4gICAgICAgICAgICAgIGFjY291bnRJZDogYWNjb3VudC5hY2NvdW50SWQsXG4gICAgICAgICAgICAgIGxhbmd1YWdlOiAnSEVCUkVXJyxcbiAgICAgICAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgICAgICAgIGN1cnNvcixcbiAgICAgICAgICAgICAgICBsaW1pdDogNTAsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hY2Nlc3NUb2tlbn1gIH0sXG4gICAgICAgICAgKTtcblxuICAgICAgbW92ZW1lbnRzLnVuc2hpZnQoLi4ubmV3TW92ZW1lbnRzKTtcbiAgICAgIGN1cnNvciA9IHBhZ2luYXRpb24uY3Vyc29yO1xuICAgICAgaWYgKCFwYWdpbmF0aW9uLmhhc01vcmUpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbW92ZW1lbnRzLnNvcnQoKHgsIHkpID0+IG5ldyBEYXRlKHgubW92ZW1lbnRUaW1lc3RhbXApLnZhbHVlT2YoKSAtIG5ldyBEYXRlKHkubW92ZW1lbnRUaW1lc3RhbXApLnZhbHVlT2YoKSk7XG5cbiAgICBjb25zdCBtYXRjaGluZ01vdmVtZW50cyA9IG1vdmVtZW50cy5maWx0ZXIoKG1vdmVtZW50KSA9PiBuZXcgRGF0ZShtb3ZlbWVudC5tb3ZlbWVudFRpbWVzdGFtcCkgPj0gc3RhcnREYXRlKTtcbiAgICByZXR1cm4ge1xuICAgICAgYWNjb3VudE51bWJlcjogcG9ydGZvbGlvLnBvcnRmb2xpb051bSxcbiAgICAgIGJhbGFuY2U6ICFtb3ZlbWVudHMubGVuZ3RoID8gMCA6IHBhcnNlRmxvYXQobW92ZW1lbnRzW21vdmVtZW50cy5sZW5ndGggLSAxXS5ydW5uaW5nQmFsYW5jZSksXG4gICAgICB0eG5zOiBtYXRjaGluZ01vdmVtZW50cy5tYXAoKG1vdmVtZW50KTogU2NyYXBpbmdUcmFuc2FjdGlvbiA9PiB7XG4gICAgICAgIGNvbnN0IGhhc0luc3RhbGxtZW50cyA9IG1vdmVtZW50LnRyYW5zYWN0aW9uPy5lbnJpY2htZW50Py5yZWN1cnJlbmNlcz8uc29tZSgoeCkgPT4geC5pc1JlY3VycmVudCk7XG4gICAgICAgIGNvbnN0IG1vZGlmaWVyID0gbW92ZW1lbnQuY3JlZGl0RGViaXQgPT09ICdERUJJVCcgPyAtMSA6IDE7XG4gICAgICAgIHJldHVybiAoe1xuICAgICAgICAgIGlkZW50aWZpZXI6IG1vdmVtZW50Lm1vdmVtZW50SWQsXG4gICAgICAgICAgZGF0ZTogbW92ZW1lbnQudmFsdWVEYXRlLFxuICAgICAgICAgIGNoYXJnZWRBbW91bnQ6ICgrbW92ZW1lbnQubW92ZW1lbnRBbW91bnQpICogbW9kaWZpZXIsXG4gICAgICAgICAgY2hhcmdlZEN1cnJlbmN5OiBtb3ZlbWVudC5tb3ZlbWVudEN1cnJlbmN5LFxuICAgICAgICAgIG9yaWdpbmFsQW1vdW50OiAoK21vdmVtZW50Lm1vdmVtZW50QW1vdW50KSAqIG1vZGlmaWVyLFxuICAgICAgICAgIG9yaWdpbmFsQ3VycmVuY3k6IG1vdmVtZW50Lm1vdmVtZW50Q3VycmVuY3ksXG4gICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuc2FuaXRpemVIZWJyZXcobW92ZW1lbnQuZGVzY3JpcHRpb24pLFxuICAgICAgICAgIHByb2Nlc3NlZERhdGU6IG1vdmVtZW50Lm1vdmVtZW50VGltZXN0YW1wLFxuICAgICAgICAgIHN0YXR1czogVHJhbnNhY3Rpb25TdGF0dXNlcy5Db21wbGV0ZWQsXG4gICAgICAgICAgdHlwZTogaGFzSW5zdGFsbG1lbnRzID8gVHJhbnNhY3Rpb25UeXBlcy5JbnN0YWxsbWVudHMgOiBUcmFuc2FjdGlvblR5cGVzLk5vcm1hbCxcbiAgICAgICAgfSk7XG4gICAgICB9KSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIG9uZSB6ZXJvIGhlYnJldyBzdHJpbmdzIGFyZSByZXZlcnNlZCB3aXRoIGEgdW5pY29kZSBjb250cm9sIGNoYXJhY3RlciB0aGF0IGZvcmNlcyBkaXNwbGF5IGluIExUUiBvcmRlclxuICAgKiBXZSBuZWVkIHRvIHJlbW92ZSB0aGUgdW5pY29kZSBjb250cm9sIGNoYXJhY3RlciwgYW5kIHRoZW4gcmV2ZXJzZSBoZWJyZXcgc3Vic3RyaW5ncyBpbnNpZGUgdGhlIHN0cmluZ1xuICAgKi9cbiAgcHJpdmF0ZSBzYW5pdGl6ZUhlYnJldyh0ZXh0OiBzdHJpbmcpIHtcbiAgICBpZiAoIXRleHQuaW5jbHVkZXMoJ1xcdTIwMmQnKSkge1xuICAgICAgcmV0dXJuIHRleHQudHJpbSgpO1xuICAgIH1cblxuICAgIGNvbnN0IHBsYWluU3RyaW5nID0gdGV4dC5yZXBsYWNlKC9cXHUyMDJkL2dpLCAnJykudHJpbSgpO1xuICAgIGNvbnN0IGhlYnJld1N1YlN0cmluZ3NSYW5nZXMgPSBbLi4ucGxhaW5TdHJpbmcubWF0Y2hBbGwoSEVCUkVXX1dPUkRTX1JFR0VYKV07XG4gICAgY29uc3QgcmFuZ2VzVG9SZXZlcnNlID0gaGVicmV3U3ViU3RyaW5nc1Jhbmdlcy5tYXAoKHN0cikgPT4gKFxuICAgICAgeyBzdGFydDogc3RyLmluZGV4ISwgZW5kOiBzdHIuaW5kZXghICsgc3RyWzBdLmxlbmd0aCB9KSk7XG4gICAgY29uc3Qgb3V0ID0gW107XG4gICAgbGV0IGluZGV4ID0gMDtcblxuICAgIGZvciAoY29uc3QgeyBzdGFydCwgZW5kIH0gb2YgcmFuZ2VzVG9SZXZlcnNlKSB7XG4gICAgICBvdXQucHVzaCguLi5wbGFpblN0cmluZy5zdWJzdHJpbmcoaW5kZXgsIHN0YXJ0KSk7XG4gICAgICBpbmRleCArPSAoc3RhcnQgLSBpbmRleCk7XG4gICAgICBjb25zdCByZXZlcnNlZCA9IFsuLi5wbGFpblN0cmluZy5zdWJzdHJpbmcoc3RhcnQsIGVuZCldLnJldmVyc2UoKTtcbiAgICAgIG91dC5wdXNoKC4uLnJldmVyc2VkKTtcbiAgICAgIGluZGV4ICs9IChlbmQgLSBzdGFydCk7XG4gICAgfVxuXG4gICAgb3V0LnB1c2goLi4ucGxhaW5TdHJpbmcuc3Vic3RyaW5nKGluZGV4LCBwbGFpblN0cmluZy5sZW5ndGgpKTtcblxuICAgIHJldHVybiBvdXQuam9pbignJyk7XG4gIH1cblxuICBhc3luYyBmZXRjaERhdGEoKTogUHJvbWlzZTxTY3JhcGVyU2NyYXBpbmdSZXN1bHQ+IHtcbiAgICBpZiAoIXRoaXMuYWNjZXNzVG9rZW4pIHtcbiAgICAgIHJldHVybiBjcmVhdGVHZW5lcmljRXJyb3IoJ2xvZ2luKCkgd2FzIG5vdCBjYWxsZWQnKTtcbiAgICB9XG5cbiAgICBjb25zdCBkZWZhdWx0U3RhcnRNb21lbnQgPSBtb21lbnQoKS5zdWJ0cmFjdCgxLCAneWVhcnMnKS5hZGQoMSwgJ2RheScpO1xuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IHRoaXMub3B0aW9ucy5zdGFydERhdGUgfHwgZGVmYXVsdFN0YXJ0TW9tZW50LnRvRGF0ZSgpO1xuICAgIGNvbnN0IHN0YXJ0TW9tZW50ID0gbW9tZW50Lm1heChkZWZhdWx0U3RhcnRNb21lbnQsIG1vbWVudChzdGFydERhdGUpKTtcblxuICAgIGRlYnVnKCdGZXRjaGluZyBhY2NvdW50IGxpc3QnKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmZXRjaEdyYXBocWw8eyBjdXN0b21lcjogQ3VzdG9tZXJbXSB9PihHUkFQSFFMX0FQSV9VUkwsIEdFVF9DVVNUT01FUiwge30sIHsgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYWNjZXNzVG9rZW59YCB9KTtcbiAgICBjb25zdCBwb3J0Zm9saW9zID0gcmVzdWx0LmN1c3RvbWVyLmZsYXRNYXAoKGN1c3RvbWVyKSA9PiAoY3VzdG9tZXIucG9ydGZvbGlvcyB8fCBbXSkpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBhY2NvdW50czogYXdhaXQgUHJvbWlzZS5hbGwocG9ydGZvbGlvcy5tYXAoXG4gICAgICAgIChwb3J0Zm9saW8pID0+IHRoaXMuZmV0Y2hQb3J0Zm9saW9Nb3ZlbWVudHMocG9ydGZvbGlvLCBzdGFydE1vbWVudC50b0RhdGUoKSksXG4gICAgICApKSxcbiAgICB9O1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxNQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxNQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxhQUFBLEdBQUFILE9BQUE7QUFNQSxJQUFBSSxZQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxPQUFBLEdBQUFMLE9BQUE7QUFLQSxJQUFBTSxlQUFBLEdBQUFOLE9BQUE7QUFBaUUsU0FBQUQsdUJBQUFRLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxTQUFBRyxnQkFBQUgsQ0FBQSxFQUFBSSxDQUFBLEVBQUFDLENBQUEsWUFBQUQsQ0FBQSxHQUFBRSxjQUFBLENBQUFGLENBQUEsTUFBQUosQ0FBQSxHQUFBTyxNQUFBLENBQUFDLGNBQUEsQ0FBQVIsQ0FBQSxFQUFBSSxDQUFBLElBQUFLLEtBQUEsRUFBQUosQ0FBQSxFQUFBSyxVQUFBLE1BQUFDLFlBQUEsTUFBQUMsUUFBQSxVQUFBWixDQUFBLENBQUFJLENBQUEsSUFBQUMsQ0FBQSxFQUFBTCxDQUFBO0FBQUEsU0FBQU0sZUFBQUQsQ0FBQSxRQUFBUSxDQUFBLEdBQUFDLFlBQUEsQ0FBQVQsQ0FBQSx1Q0FBQVEsQ0FBQSxHQUFBQSxDQUFBLEdBQUFBLENBQUE7QUFBQSxTQUFBQyxhQUFBVCxDQUFBLEVBQUFELENBQUEsMkJBQUFDLENBQUEsS0FBQUEsQ0FBQSxTQUFBQSxDQUFBLE1BQUFMLENBQUEsR0FBQUssQ0FBQSxDQUFBVSxNQUFBLENBQUFDLFdBQUEsa0JBQUFoQixDQUFBLFFBQUFhLENBQUEsR0FBQWIsQ0FBQSxDQUFBaUIsSUFBQSxDQUFBWixDQUFBLEVBQUFELENBQUEsdUNBQUFTLENBQUEsU0FBQUEsQ0FBQSxZQUFBSyxTQUFBLHlFQUFBZCxDQUFBLEdBQUFlLE1BQUEsR0FBQUMsTUFBQSxFQUFBZixDQUFBO0FBRWpFLE1BQU1nQixrQkFBa0IsR0FBRywwREFBMEQ7QUFFckYsTUFBTUMsS0FBSyxHQUFHLElBQUFDLGVBQVEsRUFBQyxVQUFVLENBQUM7QUE2RGxDLE1BQU1DLG1CQUFtQixHQUFHLG1DQUFtQztBQUUvRCxNQUFNQyxlQUFlLEdBQUcsa0RBQWtEO0FBUzNELE1BQU1DLGNBQWMsU0FBU0Msd0JBQVcsQ0FBNkI7RUFBQUMsWUFBQSxHQUFBQyxJQUFBO0lBQUEsU0FBQUEsSUFBQTtJQUFBMUIsZUFBQTtJQUFBQSxlQUFBO0VBQUE7RUFLbEYsTUFBTTJCLG9CQUFvQkEsQ0FBQ0MsV0FBbUIsRUFBOEM7SUFDMUYsSUFBSSxDQUFDQSxXQUFXLENBQUNDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRTtNQUNoQyxPQUFPLElBQUFDLDBCQUFrQixFQUFDLDhGQUE4RixDQUFDO0lBQzNIO0lBRUFYLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQztJQUM5QixNQUFNWSxtQkFBbUIsR0FBRyxNQUFNLElBQUFDLGdCQUFTLEVBQUMsR0FBR1gsbUJBQW1CLGdCQUFnQixFQUFFO01BQ2xGWSxXQUFXLEVBQUUsUUFBUTtNQUNyQkMsRUFBRSxFQUFFO0lBQ04sQ0FBQyxDQUFDO0lBRUYsTUFBTTtNQUFFQyxVQUFVLEVBQUU7UUFBRUM7TUFBWTtJQUFFLENBQUMsR0FBR0wsbUJBQW1CO0lBRTNEWixLQUFLLENBQUMsK0JBQStCUyxXQUFXLEVBQUUsQ0FBQztJQUVuRCxNQUFNUyxrQkFBa0IsR0FBRyxNQUFNLElBQUFMLGdCQUFTLEVBQUMsR0FBR1gsbUJBQW1CLGNBQWMsRUFBRTtNQUMvRWlCLFdBQVcsRUFBRVYsV0FBVztNQUN4QlEsV0FBVztNQUNYRyxVQUFVLEVBQUU7SUFDZCxDQUFDLENBQUM7SUFFRixNQUFNO01BQUVKLFVBQVUsRUFBRTtRQUFFSztNQUFXO0lBQUUsQ0FBQyxHQUFHSCxrQkFBa0I7SUFFekQsSUFBSSxDQUFDRyxVQUFVLEdBQUdBLFVBQVU7SUFFNUIsT0FBTztNQUNMQyxPQUFPLEVBQUU7SUFDWCxDQUFDO0VBQ0g7RUFFQSxNQUFhQyx5QkFBeUJBLENBQUNDLE9BQWUsRUFBbUQ7SUFDdkcsSUFBSSxDQUFDLElBQUksQ0FBQ0gsVUFBVSxFQUFFO01BQ3BCLE9BQU8sSUFBQVYsMEJBQWtCLEVBQUMsaUVBQWlFLENBQUM7SUFDOUY7SUFFQVgsS0FBSyxDQUFDLHNCQUFzQixDQUFDO0lBQzdCLE1BQU15QixpQkFBaUIsR0FBRyxNQUFNLElBQUFaLGdCQUFTLEVBQUMsR0FBR1gsbUJBQW1CLGFBQWEsRUFBRTtNQUM3RW1CLFVBQVUsRUFBRSxJQUFJLENBQUNBLFVBQVU7TUFDM0JHO0lBQ0YsQ0FBQyxDQUFDO0lBRUYsTUFBTTtNQUFFUixVQUFVLEVBQUU7UUFBRVU7TUFBUztJQUFFLENBQUMsR0FBR0QsaUJBQWlCO0lBQ3RELE9BQU87TUFBRUgsT0FBTyxFQUFFLElBQUk7TUFBRUssMEJBQTBCLEVBQUVEO0lBQVMsQ0FBQztFQUNoRTtFQUVBLE1BQWNFLGVBQWVBLENBQzNCQyxXQUF1QyxFQUNVO0lBQ2pELElBQUksa0JBQWtCLElBQUlBLFdBQVcsRUFBRTtNQUNyQyxJQUFJLENBQUNBLFdBQVcsQ0FBQ0MsZ0JBQWdCLEVBQUU7UUFDakMsT0FBTyxJQUFBbkIsMEJBQWtCLEVBQUMsMEJBQTBCLENBQUM7TUFDdkQ7TUFDQSxPQUFPO1FBQUVXLE9BQU8sRUFBRSxJQUFJO1FBQUVLLDBCQUEwQixFQUFFRSxXQUFXLENBQUNDO01BQWlCLENBQUM7SUFDcEY7SUFFQSxJQUFJLENBQUNELFdBQVcsQ0FBQ0UsZ0JBQWdCLEVBQUU7TUFDakMsT0FBTztRQUNMVCxPQUFPLEVBQUUsS0FBSztRQUNkVSxTQUFTLEVBQUVDLHlCQUFpQixDQUFDQyx5QkFBeUI7UUFDdERDLFlBQVksRUFBRTtNQUNoQixDQUFDO0lBQ0g7SUFFQSxJQUFJLENBQUNOLFdBQVcsQ0FBQ3BCLFdBQVcsRUFBRTtNQUM1QixPQUFPLElBQUFFLDBCQUFrQixFQUFDLG9FQUFvRSxDQUFDO0lBQ2pHO0lBRUFYLEtBQUssQ0FBQyxvREFBb0QsQ0FBQztJQUMzRCxNQUFNb0MsYUFBYSxHQUFHLE1BQU0sSUFBSSxDQUFDNUIsb0JBQW9CLENBQUNxQixXQUFXLENBQUNwQixXQUFXLENBQUM7SUFFOUUsSUFBSSxDQUFDMkIsYUFBYSxDQUFDZCxPQUFPLEVBQUU7TUFDMUIsT0FBT2MsYUFBYTtJQUN0QjtJQUVBLE1BQU1aLE9BQU8sR0FBRyxNQUFNSyxXQUFXLENBQUNFLGdCQUFnQixDQUFDLENBQUM7SUFFcEQsTUFBTU0sY0FBYyxHQUFHLE1BQU0sSUFBSSxDQUFDZCx5QkFBeUIsQ0FBQ0MsT0FBTyxDQUFDO0lBQ3BFLElBQUksQ0FBQ2EsY0FBYyxDQUFDZixPQUFPLEVBQUU7TUFDM0IsT0FBT2UsY0FBYztJQUN2QjtJQUVBLE9BQU87TUFBRWYsT0FBTyxFQUFFLElBQUk7TUFBRUssMEJBQTBCLEVBQUVVLGNBQWMsQ0FBQ1Y7SUFBMkIsQ0FBQztFQUNqRztFQUVBLE1BQU1XLEtBQUtBLENBQUNULFdBQXVDLEVBQ3ZCO0lBQzFCLE1BQU1RLGNBQWMsR0FBRyxNQUFNLElBQUksQ0FBQ1QsZUFBZSxDQUFDQyxXQUFXLENBQUM7SUFDOUQsSUFBSSxDQUFDUSxjQUFjLENBQUNmLE9BQU8sRUFBRTtNQUMzQixPQUFPZSxjQUFjO0lBQ3ZCO0lBRUFyQyxLQUFLLENBQUMscUJBQXFCLENBQUM7SUFDNUIsTUFBTXVDLGtCQUFrQixHQUFHLE1BQU0sSUFBQTFCLGdCQUFTLEVBQUMsR0FBR1gsbUJBQW1CLGFBQWEsRUFBRTtNQUM5RXNDLFdBQVcsRUFBRUgsY0FBYyxDQUFDViwwQkFBMEI7TUFDdERjLEtBQUssRUFBRVosV0FBVyxDQUFDWSxLQUFLO01BQ3hCQyxJQUFJLEVBQUViLFdBQVcsQ0FBQ2MsUUFBUTtNQUMxQkMsT0FBTyxFQUFFO0lBQ1gsQ0FBQyxDQUFDO0lBRUYsTUFBTTtNQUFFNUIsVUFBVSxFQUFFO1FBQUU2QjtNQUFRO0lBQUUsQ0FBQyxHQUFHTixrQkFBa0I7SUFFdER2QyxLQUFLLENBQUMsMEJBQTBCLENBQUM7SUFFakMsTUFBTThDLHVCQUF1QixHQUFHLE1BQU0sSUFBQWpDLGdCQUFTLEVBQUMsR0FBR1gsbUJBQW1CLGlCQUFpQixFQUFFO01BQ3ZGMkMsT0FBTztNQUNQSCxJQUFJLEVBQUViLFdBQVcsQ0FBQ2M7SUFDcEIsQ0FBQyxDQUFDO0lBRUYsTUFBTTtNQUFFM0IsVUFBVSxFQUFFO1FBQUUrQjtNQUFZO0lBQUUsQ0FBQyxHQUFHRCx1QkFBdUI7SUFFL0QsSUFBSSxDQUFDQyxXQUFXLEdBQUdBLFdBQVc7SUFFOUIsT0FBTztNQUNMekIsT0FBTyxFQUFFLElBQUk7TUFDYjBCLGtCQUFrQixFQUFFWCxjQUFjLENBQUNWO0lBQ3JDLENBQUM7RUFDSDtFQUVBLE1BQWNzQix1QkFBdUJBLENBQUNDLFNBQW9CLEVBQUVDLFNBQWUsRUFBZ0M7SUFDekc7SUFDQSxNQUFNQyxPQUFPLEdBQUdGLFNBQVMsQ0FBQ0csUUFBUSxDQUFDLENBQUMsQ0FBQztJQUNyQyxJQUFJQyxNQUFNLEdBQUcsSUFBSTtJQUNqQixNQUFNQyxTQUFTLEdBQUcsRUFBRTtJQUVwQixPQUFPLENBQUNBLFNBQVMsQ0FBQ0MsTUFBTSxJQUFJLElBQUlDLElBQUksQ0FBQ0YsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDRyxpQkFBaUIsQ0FBQyxJQUFJUCxTQUFTLEVBQUU7TUFDakZuRCxLQUFLLENBQUMscUNBQXFDa0QsU0FBUyxDQUFDUyxZQUFZLEtBQUssQ0FBQztNQUN2RSxNQUFNO1FBQUVKLFNBQVMsRUFBRTtVQUFFQSxTQUFTLEVBQUVLLFlBQVk7VUFBRUM7UUFBVztNQUNXLENBQUMsR0FDakUsTUFBTSxJQUFBQyxtQkFBWSxFQUNoQjNELGVBQWUsRUFDZjRELDZCQUFhLEVBQUU7UUFDYkMsV0FBVyxFQUFFZCxTQUFTLENBQUNjLFdBQVc7UUFDbENDLFNBQVMsRUFBRWIsT0FBTyxDQUFDYSxTQUFTO1FBQzVCQyxRQUFRLEVBQUUsUUFBUTtRQUNsQkwsVUFBVSxFQUFFO1VBQ1ZQLE1BQU07VUFDTmEsS0FBSyxFQUFFO1FBQ1Q7TUFDRixDQUFDLEVBQ0Q7UUFBRUMsYUFBYSxFQUFFLFVBQVUsSUFBSSxDQUFDckIsV0FBVztNQUFHLENBQ2hELENBQUM7TUFFTFEsU0FBUyxDQUFDYyxPQUFPLENBQUMsR0FBR1QsWUFBWSxDQUFDO01BQ2xDTixNQUFNLEdBQUdPLFVBQVUsQ0FBQ1AsTUFBTTtNQUMxQixJQUFJLENBQUNPLFVBQVUsQ0FBQ1MsT0FBTyxFQUFFO1FBQ3ZCO01BQ0Y7SUFDRjtJQUVBZixTQUFTLENBQUNnQixJQUFJLENBQUMsQ0FBQ0MsQ0FBQyxFQUFFQyxDQUFDLEtBQUssSUFBSWhCLElBQUksQ0FBQ2UsQ0FBQyxDQUFDZCxpQkFBaUIsQ0FBQyxDQUFDZ0IsT0FBTyxDQUFDLENBQUMsR0FBRyxJQUFJakIsSUFBSSxDQUFDZ0IsQ0FBQyxDQUFDZixpQkFBaUIsQ0FBQyxDQUFDZ0IsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUUzRyxNQUFNQyxpQkFBaUIsR0FBR3BCLFNBQVMsQ0FBQ3FCLE1BQU0sQ0FBRUMsUUFBUSxJQUFLLElBQUlwQixJQUFJLENBQUNvQixRQUFRLENBQUNuQixpQkFBaUIsQ0FBQyxJQUFJUCxTQUFTLENBQUM7SUFDM0csT0FBTztNQUNMMkIsYUFBYSxFQUFFNUIsU0FBUyxDQUFDUyxZQUFZO01BQ3JDb0IsT0FBTyxFQUFFLENBQUN4QixTQUFTLENBQUNDLE1BQU0sR0FBRyxDQUFDLEdBQUd3QixVQUFVLENBQUN6QixTQUFTLENBQUNBLFNBQVMsQ0FBQ0MsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDeUIsY0FBYyxDQUFDO01BQzNGQyxJQUFJLEVBQUVQLGlCQUFpQixDQUFDUSxHQUFHLENBQUVOLFFBQVEsSUFBMEI7UUFBQSxJQUFBTyxxQkFBQTtRQUM3RCxNQUFNQyxlQUFlLElBQUFELHFCQUFBLEdBQUdQLFFBQVEsQ0FBQ1MsV0FBVyxjQUFBRixxQkFBQSxnQkFBQUEscUJBQUEsR0FBcEJBLHFCQUFBLENBQXNCRyxVQUFVLGNBQUFILHFCQUFBLGdCQUFBQSxxQkFBQSxHQUFoQ0EscUJBQUEsQ0FBa0NJLFdBQVcsY0FBQUoscUJBQUEsdUJBQTdDQSxxQkFBQSxDQUErQ0ssSUFBSSxDQUFFakIsQ0FBQyxJQUFLQSxDQUFDLENBQUNrQixXQUFXLENBQUM7UUFDakcsTUFBTUMsUUFBUSxHQUFHZCxRQUFRLENBQUNlLFdBQVcsS0FBSyxPQUFPLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUMxRCxPQUFRO1VBQ05DLFVBQVUsRUFBRWhCLFFBQVEsQ0FBQ2lCLFVBQVU7VUFDL0JDLElBQUksRUFBRWxCLFFBQVEsQ0FBQ21CLFNBQVM7VUFDeEJDLGFBQWEsRUFBRyxDQUFDcEIsUUFBUSxDQUFDcUIsY0FBYyxHQUFJUCxRQUFRO1VBQ3BEUSxlQUFlLEVBQUV0QixRQUFRLENBQUN1QixnQkFBZ0I7VUFDMUNDLGNBQWMsRUFBRyxDQUFDeEIsUUFBUSxDQUFDcUIsY0FBYyxHQUFJUCxRQUFRO1VBQ3JEVyxnQkFBZ0IsRUFBRXpCLFFBQVEsQ0FBQ3VCLGdCQUFnQjtVQUMzQ0csV0FBVyxFQUFFLElBQUksQ0FBQ0MsY0FBYyxDQUFDM0IsUUFBUSxDQUFDMEIsV0FBVyxDQUFDO1VBQ3RERSxhQUFhLEVBQUU1QixRQUFRLENBQUNuQixpQkFBaUI7VUFDekNnRCxNQUFNLEVBQUVDLGlDQUFtQixDQUFDQyxTQUFTO1VBQ3JDQyxJQUFJLEVBQUV4QixlQUFlLEdBQUd5Qiw4QkFBZ0IsQ0FBQ0MsWUFBWSxHQUFHRCw4QkFBZ0IsQ0FBQ0U7UUFDM0UsQ0FBQztNQUNILENBQUM7SUFDSCxDQUFDO0VBQ0g7O0VBRUE7QUFDRjtBQUNBO0FBQ0E7RUFDVVIsY0FBY0EsQ0FBQ1MsSUFBWSxFQUFFO0lBQ25DLElBQUksQ0FBQ0EsSUFBSSxDQUFDQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUU7TUFDNUIsT0FBT0QsSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQztJQUNwQjtJQUVBLE1BQU1DLFdBQVcsR0FBR0gsSUFBSSxDQUFDSSxPQUFPLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxDQUFDRixJQUFJLENBQUMsQ0FBQztJQUN2RCxNQUFNRyxzQkFBc0IsR0FBRyxDQUFDLEdBQUdGLFdBQVcsQ0FBQ0csUUFBUSxDQUFDeEgsa0JBQWtCLENBQUMsQ0FBQztJQUM1RSxNQUFNeUgsZUFBZSxHQUFHRixzQkFBc0IsQ0FBQ25DLEdBQUcsQ0FBRXNDLEdBQUcsS0FDckQ7TUFBRUMsS0FBSyxFQUFFRCxHQUFHLENBQUNFLEtBQU07TUFBRUMsR0FBRyxFQUFFSCxHQUFHLENBQUNFLEtBQUssR0FBSUYsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDakU7SUFBTyxDQUFDLENBQUMsQ0FBQztJQUMxRCxNQUFNcUUsR0FBRyxHQUFHLEVBQUU7SUFDZCxJQUFJRixLQUFLLEdBQUcsQ0FBQztJQUViLEtBQUssTUFBTTtNQUFFRCxLQUFLO01BQUVFO0lBQUksQ0FBQyxJQUFJSixlQUFlLEVBQUU7TUFDNUNLLEdBQUcsQ0FBQ0MsSUFBSSxDQUFDLEdBQUdWLFdBQVcsQ0FBQ1csU0FBUyxDQUFDSixLQUFLLEVBQUVELEtBQUssQ0FBQyxDQUFDO01BQ2hEQyxLQUFLLElBQUtELEtBQUssR0FBR0MsS0FBTTtNQUN4QixNQUFNSyxRQUFRLEdBQUcsQ0FBQyxHQUFHWixXQUFXLENBQUNXLFNBQVMsQ0FBQ0wsS0FBSyxFQUFFRSxHQUFHLENBQUMsQ0FBQyxDQUFDSyxPQUFPLENBQUMsQ0FBQztNQUNqRUosR0FBRyxDQUFDQyxJQUFJLENBQUMsR0FBR0UsUUFBUSxDQUFDO01BQ3JCTCxLQUFLLElBQUtDLEdBQUcsR0FBR0YsS0FBTTtJQUN4QjtJQUVBRyxHQUFHLENBQUNDLElBQUksQ0FBQyxHQUFHVixXQUFXLENBQUNXLFNBQVMsQ0FBQ0osS0FBSyxFQUFFUCxXQUFXLENBQUM1RCxNQUFNLENBQUMsQ0FBQztJQUU3RCxPQUFPcUUsR0FBRyxDQUFDSyxJQUFJLENBQUMsRUFBRSxDQUFDO0VBQ3JCO0VBRUEsTUFBTUMsU0FBU0EsQ0FBQSxFQUFtQztJQUNoRCxJQUFJLENBQUMsSUFBSSxDQUFDcEYsV0FBVyxFQUFFO01BQ3JCLE9BQU8sSUFBQXBDLDBCQUFrQixFQUFDLHdCQUF3QixDQUFDO0lBQ3JEO0lBRUEsTUFBTXlILGtCQUFrQixHQUFHLElBQUFDLGVBQU0sRUFBQyxDQUFDLENBQUNDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDO0lBQ3RFLE1BQU1wRixTQUFTLEdBQUcsSUFBSSxDQUFDcUYsT0FBTyxDQUFDckYsU0FBUyxJQUFJaUYsa0JBQWtCLENBQUNLLE1BQU0sQ0FBQyxDQUFDO0lBQ3ZFLE1BQU1DLFdBQVcsR0FBR0wsZUFBTSxDQUFDTSxHQUFHLENBQUNQLGtCQUFrQixFQUFFLElBQUFDLGVBQU0sRUFBQ2xGLFNBQVMsQ0FBQyxDQUFDO0lBRXJFbkQsS0FBSyxDQUFDLHVCQUF1QixDQUFDO0lBQzlCLE1BQU00SSxNQUFNLEdBQUcsTUFBTSxJQUFBOUUsbUJBQVksRUFBMkIzRCxlQUFlLEVBQUUwSSw0QkFBWSxFQUFFLENBQUMsQ0FBQyxFQUFFO01BQUV6RSxhQUFhLEVBQUUsVUFBVSxJQUFJLENBQUNyQixXQUFXO0lBQUcsQ0FBQyxDQUFDO0lBQy9JLE1BQU0rRixVQUFVLEdBQUdGLE1BQU0sQ0FBQ0csUUFBUSxDQUFDQyxPQUFPLENBQUVELFFBQVEsSUFBTUEsUUFBUSxDQUFDRCxVQUFVLElBQUksRUFBRyxDQUFDO0lBRXJGLE9BQU87TUFDTHhILE9BQU8sRUFBRSxJQUFJO01BQ2IrQixRQUFRLEVBQUUsTUFBTTRGLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDSixVQUFVLENBQUMzRCxHQUFHLENBQ3ZDakMsU0FBUyxJQUFLLElBQUksQ0FBQ0QsdUJBQXVCLENBQUNDLFNBQVMsRUFBRXdGLFdBQVcsQ0FBQ0QsTUFBTSxDQUFDLENBQUMsQ0FDN0UsQ0FBQztJQUNILENBQUM7RUFDSDtBQUNGO0FBQUNVLE9BQUEsQ0FBQXZLLE9BQUEsR0FBQXdCLGNBQUEiLCJpZ25vcmVMaXN0IjpbXX0=